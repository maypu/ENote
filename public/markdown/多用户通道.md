## 多用户通道

### 介绍
对于需要同时给多个用户发送消息的应用，可在后台申请**多用户通道**（目前最多申请三个），自己每个应用都可以接入一个通道，便于管理用户。

多用户通道分为两类：

 1. 对点通道
 通过本程序生成临时二维码放置在自己的应用中，并引导用户扫码，扫码后接口主动返回用户ID与其他基本信息，该类方式的优势在于自己的用户系统可以与用户微信关联，实现特定用户的自定义推送，自由度更高。（推荐使用此类方式）
 
 3. 群发通道
 通过本平台生成固定二维码后可通过社交平台来传播二维码引导关注的方式，这类方式在群发时只能给全体的扫码成员群发，不能识别用户何时扫码，但有接口查看所有扫码用户。


### 对点通道

 1. 请求关注二维码

get请求：

    https://epusher.ebans.net/api/qrcode?clint_id=通道ID&state=state
 
>  state参数请使用不易被猜测的用户标识，以免用户之前相互随意重置关联的微信

2. 用户扫码后自动跳转redirect_url并附带用户唯一code

    redirect_url?code=用户唯一code&state=state

> 注：同一用户在不同的通道ID所生成的用户code不一致，请勿混用不同通道的用户唯一code，否则会返回用户不存在

3. 在该页面(redirect_url)通过code发起post请求，请求用户基本信息

    /api/auth/userinfo?clint_id=通道ID&code=用户唯一code

返回用户信息成功后，可将用户唯一code和基本信息存储，后续发
送通知消息都可通过该code发送
